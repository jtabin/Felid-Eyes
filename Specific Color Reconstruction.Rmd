---
title: 'Specific Color Reconstruction'
output: html_document
---

```{r}
# load packages
library(phytools)
library(corHMM)
library(expm)
library(dplyr)
library(plotrix)
```

```{r}
# short tree with zeros replaced with 0.0000001
mytr_short <- read.tree(text = "((((((((((((Felis_silvestris:0.00132,((Felis_lybica_cafra:0.0000001,Felis_lybica_ornata:0.0000001,Felis_lybica_lybica:0.0000001):0.00157,Felis_bieti:0.00114):0.00042):0.00108,Felis_margarita:0.00313):0.00066,Felis_nigripes:0.00227):0.00042,(Felis_chaus_chaus:0.0000001,Felis_chaus_affinis:0.0000001):0.00301):0.00265,(((((Prionailurus_bengalensis_bengalensis:0.0000001,Prionailurus_bengalensis_iriomotensis:0.0000001,Prionailurus_javanensis:0.0000001):0.00175,Prionailurus_viverrinus:0.00301):0.00054,Prionailurus_planiceps:0.00247):0.00151,Prionailurus_rubiginosus:0.00307):0.00102,Otocolobus_manul:0.00614):0.00036):0.00054,((Puma_concolor:0.00361,Herpailurus_yagouaroundi:0.00313):0.00054,Acinonyx_jubatus:0.00464):0.00157):0.00054,(((Lynx_pardinus:0.00108,Lynx_lynx:0.00096):0.00036,Lynx_canadensis:0.00114):0.00102,Lynx_rufus:0.00337):0.00367):0.00084,(((((Leopardus_geoffroyi:0.00102,Leopardus_guigna:0.00102):0.0000001,Leopardus_guttulus:0.0000001):0.00036,Leopardus_tigrinus:0.00108):0.00139,(Leopardus_colocola_pajeros:0.00078,Leopardus_jacobita:0.00163):0.00139):0.00067,(Leopardus_wiedii:0.00163,Leopardus_pardalis_pardalis:0.00205):0.00090):0.00554):0.00060,((Caracal_caracal:0.00175,Caracal_aurata:0.00199):0.00367,Leptailurus_serval:0.00530):0.00283):0.00096,((Catopuma_badia:0.00265,Catopuma_temminckii:0.00349):0.00108,Pardofelis_marmorata:0.00470):0.00313):0.00157,(((((Panthera_leo_melanochaita:0.0000001,Panthera_leo_persica:0.0000001,Panthera_leo_leo:0.0000001):0.00102,Panthera_onca:0.00223):0.00048,(Panthera_pardus_orientalis:0.0000001,Panthera_pardus_tulliana:0.0000001,Panthera_pardus_fusca:0.0000001):0.00199):0.00066,((Panthera_tigris_tigris_corbetti:0.0000001,Panthera_tigris_tigris_tigris:0.0000001,Panthera_tigris_tigris_altaica:0.0000001,Panthera_tigris_sondaica:0.0000001,Panthera_tigris_tigris_amoyensis:0.0000001,Panthera_tigris_tigris_jacksoni:0.0000001):0.00187,Panthera_uncia:0.00295):0.00078):0.00217,(Neofelis_nebulosa:0.0000001,Neofelis_diardi:0.0000001):0.00464):0.00398):0.03265,Prionodon_linsang:0.03801);")
plot(mytr_short)

#mytr_long <- read.tree(text = "((((((((((((Felis_silvestris:0.00132,(Felis_lybica_cafra:0.00157,Felis_lybica_ornata:0.00157,Felis_lybica_lybica:0.00157,Felis_bieti:0.00114):0.00042):0.00108,Felis_margarita:0.00313):0.00066,Felis_nigripes:0.00227):0.00042,Felis_chaus_chaus:0.00301,Felis_chaus_affinis:0.00301):0.00265,((((Prionailurus_bengalensis_bengalensis:0.00175,Prionailurus_bengalensis_iriomotensis:0.00175,Prionailurus_javanensis:0.00175,Prionailurus_viverrinus:0.00301):0.00054,Prionailurus_planiceps:0.00247):0.00151,Prionailurus_rubiginosus:0.00307):0.00102,Otocolobus_manul:0.00614):0.00036):0.00054,((Puma_concolor:0.00361,Herpailurus_yagouaroundi:0.00313):0.00054,Acinonyx_jubatus:0.00464):0.00157):0.00054,(((Lynx_pardinus:0.00108,Lynx_lynx:0.00096):0.00036,Lynx_canadensis:0.00114):0.00102,Lynx_rufus:0.00337):0.00367):0.00084,((((Leopardus_geoffroyi:0.00102,Leopardus_guigna:0.00102):0.00036,Leopardus_guttulus:0.00138,Leopardus_tigrinus:0.00108):0.00139,(Leopardus_colocola_pajeros:0.00078,Leopardus_jacobita:0.00163):0.00139):0.00067,(Leopardus_wiedii:0.00163,Leopardus_pardalis_pardalis:0.00205):0.00090):0.00554):0.00060,((Caracal_caracal:0.00175,Caracal_aurata:0.00199):0.00367,Leptailurus_serval:0.00530):0.00283):0.00096,((Catopuma_badia:0.00265,Catopuma_temminckii:0.00349):0.00108,Pardofelis_marmorata:0.00470):0.00313):0.00157,((((Panthera_leo_melanochaita:0.00102,Panthera_leo_persica:0.00102,Panthera_leo_leo:0.00102,Panthera_onca:0.00223):0.00048,Panthera_pardus_orientalis:0.00199,Panthera_pardus_tulliana:0.00199,Panthera_pardus_fusca:0.00199):0.00066,(Panthera_tigris_tigris_corbetti:0.00187,Panthera_tigris_tigris_tigris:0.00187,Panthera_tigris_tigris_altaica:0.00187,Panthera_tigris_sondaica:0.00187,Panthera_tigris_tigris_amoyensis:0.00187,Panthera_tigris_tigris_jacksoni:0.00187,Panthera_uncia:0.00295):0.00078):0.00217,Neofelis_nebulosa:0.00464,Neofelis_diardi:0.00464):0.00398):0.03265,Prionodon_linsang:0.03801);")

# add node labels
mytr_short <- makeNodeLabel(mytr_short, method = "number", prefix = "Node")
```

```{r}
# 5 trees, for each color
mytr_brown_short <- drop.tip(mytr_short, c("Panthera_uncia","Panthera_tigris_tigris_jacksoni","Panthera_tigris_tigris_amoyensis","Panthera_tigris_sondaica","Panthera_tigris_tigris_altaica","Panthera_tigris_tigris_tigris","Panthera_tigris_tigris_corbetti","Panthera_pardus_fusca","Panthera_pardus_tulliana","Panthera_pardus_orientalis","Panthera_onca","Panthera_leo_melanochaita","Catopuma_badia","Caracal_aurata","Otocolobus_manul","Prionailurus_viverrinus","Felis_chaus_affinis","Felis_chaus_chaus","Felis_nigripes","Felis_margarita","Felis_bieti","Felis_lybica_lybica","Felis_lybica_ornata","Felis_silvestris"),trim.internal = TRUE)
mytr_gray_short <- drop.tip(mytr_short, c("Prionodon_linsang","Panthera_leo_leo","Panthera_leo_melanochaita","Pardofelis_marmorata","Catopuma_badia","Leopardus_wiedii","Leopardus_jacobita","Leopardus_tigrinus","Leopardus_guttulus","Leopardus_guigna","Lynx_canadensis","Acinonyx_jubatus","Prionailurus_javanensis","Prionailurus_bengalensis_iriomotensis","Felis_nigripes"), trim.internal = TRUE)
mytr_yelbei_short <- keep.tip(mytr_short, c("Panthera_tigris_tigris_jacksoni","Panthera_tigris_tigris_amoyensis","Panthera_tigris_sondaica","Panthera_tigris_tigris_altaica","Panthera_tigris_tigris_tigris","Panthera_tigris_tigris_corbetti","Panthera_pardus_orientalis","Panthera_onca","Panthera_leo_leo","Panthera_leo_persica","Panthera_leo_melanochaita","Catopuma_badia","Lynx_canadensis","Lynx_lynx","Acinonyx_jubatus","Puma_concolor","Otocolobus_manul","Prionailurus_rubiginosus","Prionailurus_bengalensis_iriomotensis","Prionailurus_bengalensis_bengalensis","Felis_nigripes","Felis_lybica_lybica","Felis_lybica_cafra","Lynx_pardinus"))
mytr_hazgre_short <- keep.tip(mytr_short, c("Panthera_uncia","Panthera_tigris_sondaica","Panthera_pardus_orientalis","Panthera_onca","Caracal_caracal","Leopardus_pardalis_pardalis","Leopardus_jacobita","Leopardus_geoffroyi","Lynx_lynx","Lynx_pardinus","Otocolobus_manul","Prionailurus_rubiginosus","Prionailurus_viverrinus","Felis_chaus_affinis","Felis_chaus_chaus","Felis_nigripes","Felis_margarita","Felis_lybica_lybica","Felis_lybica_ornata","Felis_lybica_cafra","Felis_silvestris"))
mytr_blue_short <- keep.tip(mytr_short, c("Panthera_uncia","Panthera_tigris_tigris_jacksoni","Panthera_pardus_fusca","Panthera_pardus_orientalis","Lynx_rufus","Felis_bieti","Felis_silvestris"))
```

# reconstruction for top of the tree brown short
```{r}
# light brown
mytr_brown_top <- drop.tip(mytr_brown_short, c("Panthera_leo_leo","Panthera_leo_persica","Felis_lybica_cafra"), trim.internal = TRUE)
gen_dat <- read.csv("general_data_reordered.csv")
gen_dat_brown_top <- gen_dat %>% select(Rename,brown_col_num,brown_light_R,brown_light_G,brown_light_B,brown_med_R,brown_med_G,brown_med_B,brown_dark_R,brown_dark_G,brown_dark_B,brown_excl_R,brown_excl_G,brown_excl_B) %>% filter(Rename %in% mytr_brown_top$tip.label)
gen_dat_brown_top_justpriR <- gen_dat_brown_top %>% select(Rename,brown_light_R)
gen_dat_brown_top_justpriR <- setNames(gen_dat_brown_top_justpriR$brown_light_R,gen_dat_brown_top_justpriR$Rename)

gen_dat_brown_top_justpriG <- gen_dat_brown_top %>% select(Rename,brown_light_G)
gen_dat_brown_top_justpriG <- setNames(gen_dat_brown_top_justpriG$brown_light_G,gen_dat_brown_top_justpriG$Rename)

gen_dat_brown_top_justpriB <- gen_dat_brown_top %>% select(Rename,brown_light_B)
gen_dat_brown_top_justpriB <- setNames(gen_dat_brown_top_justpriB$brown_light_B,gen_dat_brown_top_justpriB$Rename)

fitR<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_brown_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_brown_top_just_col_num <- gen_dat_brown_top %>% select(Rename,brown_col_num)
col_num <- rayDISC(mytr_brown_top,gen_dat_brown_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_brown_top,col_num$states,piecolors=c("white","grey","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_brown_top$node.label,temp, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium brown
mytr_brown_top <- drop.tip(mytr_brown_short, c("Panthera_leo_leo","Panthera_leo_persica","Felis_lybica_cafra"), trim.internal = TRUE)

gen_dat_brown_top <- gen_dat %>% select(Rename,brown_col_num,brown_light_R,brown_light_G,brown_light_B,brown_med_R,brown_med_G,brown_med_B,brown_dark_R,brown_dark_G,brown_dark_B,brown_excl_R,brown_excl_G,brown_excl_B) %>% filter(Rename %in% mytr_brown_top$tip.label)

gen_dat_brown_top_justpriR <- gen_dat_brown_top %>% select(Rename,brown_med_R)
gen_dat_brown_top_justpriR <- setNames(gen_dat_brown_top_justpriR$brown_med_R,gen_dat_brown_top_justpriR$Rename)

gen_dat_brown_top_justpriG <- gen_dat_brown_top %>% select(Rename,brown_med_G)
gen_dat_brown_top_justpriG <- setNames(gen_dat_brown_top_justpriG$brown_med_G,gen_dat_brown_top_justpriG$Rename)

gen_dat_brown_top_justpriB <- gen_dat_brown_top %>% select(Rename,brown_med_B)
gen_dat_brown_top_justpriB <- setNames(gen_dat_brown_top_justpriB$brown_med_B,gen_dat_brown_top_justpriB$Rename)

fitR<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_brown_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark brown
mytr_brown_top <- drop.tip(mytr_brown_short, c("Panthera_leo_leo","Panthera_leo_persica","Felis_lybica_cafra"), trim.internal = TRUE)

gen_dat_brown_top <- gen_dat %>% select(Rename,brown_col_num,brown_light_R,brown_light_G,brown_light_B,brown_med_R,brown_med_G,brown_med_B,brown_dark_R,brown_dark_G,brown_dark_B,brown_excl_R,brown_excl_G,brown_excl_B) %>% filter(Rename %in% mytr_brown_top$tip.label)

gen_dat_brown_top_justpriR <- gen_dat_brown_top %>% select(Rename,brown_dark_R)
gen_dat_brown_top_justpriR <- setNames(gen_dat_brown_top_justpriR$brown_dark_R,gen_dat_brown_top_justpriR$Rename)

gen_dat_brown_top_justpriG <- gen_dat_brown_top %>% select(Rename,brown_dark_G)
gen_dat_brown_top_justpriG <- setNames(gen_dat_brown_top_justpriG$brown_dark_G,gen_dat_brown_top_justpriG$Rename)

gen_dat_brown_top_justpriB <- gen_dat_brown_top %>% select(Rename,brown_dark_B)
gen_dat_brown_top_justpriB <- setNames(gen_dat_brown_top_justpriB$brown_dark_B,gen_dat_brown_top_justpriB$Rename)

fitR<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_brown_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_brown_top <- drop.tip(mytr_brown_short, c("Panthera_leo_leo","Panthera_leo_persica","Felis_lybica_cafra","Puma_concolor"), trim.internal = TRUE) # also drop the animals with 4 eye colors
gen_dat_brown_top_just_pri <- gen_dat %>% select(Rename,brown_pri) %>% filter(Rename %in% mytr_brown_top$tip.label)
gen_dat_brown_top_just_sec<- gen_dat %>% select(Rename,brown_sec) %>% filter(Rename %in% mytr_brown_top$tip.label)
brown_pri <- rayDISC(mytr_brown_top,gen_dat_brown_top_just_pri,model="ER",node.states="marginal")
brown_sec <- rayDISC(mytr_brown_top,gen_dat_brown_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_brown_top,brown_pri$states,piecolors=c("black","white","grey"))
plotRECON(mytr_brown_top,brown_sec$states,piecolors=c("black","white","grey"))
temp1 <- data.frame(brown_pri$states)
temp1 <-temp1 %>% mutate(brown_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(brown_sec$states)
temp2 <-temp2 %>% mutate(brown_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_brown_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```

# reconstruction for leo brown 
```{r}
# light brown
mytr_brown_top <- keep.tip(mytr_brown_short, c("Panthera_leo_leo","Panthera_leo_persica"))
gen_dat <- read.csv("general_data_reordered.csv")
gen_dat_brown_top <- gen_dat %>% select(Rename,brown_col_num,brown_light_R,brown_light_G,brown_light_B,brown_med_R,brown_med_G,brown_med_B,brown_dark_R,brown_dark_G,brown_dark_B,brown_excl_R,brown_excl_G,brown_excl_B) %>% filter(Rename %in% mytr_brown_top$tip.label)
gen_dat_brown_top_justpriR <- gen_dat_brown_top %>% select(Rename,brown_light_R)
gen_dat_brown_top_justpriR <- setNames(gen_dat_brown_top_justpriR$brown_light_R,gen_dat_brown_top_justpriR$Rename)

gen_dat_brown_top_justpriG <- gen_dat_brown_top %>% select(Rename,brown_light_G)
gen_dat_brown_top_justpriG <- setNames(gen_dat_brown_top_justpriG$brown_light_G,gen_dat_brown_top_justpriG$Rename)

gen_dat_brown_top_justpriB <- gen_dat_brown_top %>% select(Rename,brown_light_B)
gen_dat_brown_top_justpriB <- setNames(gen_dat_brown_top_justpriB$brown_light_B,gen_dat_brown_top_justpriB$Rename)

fitR<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_brown_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_brown_top_just_col_num <- gen_dat_brown_top %>% select(Rename,brown_col_num)
col_num <- rayDISC(mytr_brown_top,gen_dat_brown_top_just_col_num,model="ER",node.states="marginal")
#plotRECON(mytr_brown_top,col_num$states,piecolors=c("white","grey","black")) #doesn't work b/c both have 3
#temp <- data.frame(col_num$states)
#temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
#temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_brown_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium brown
mytr_brown_top <- keep.tip(mytr_brown_short, c("Panthera_leo_leo","Panthera_leo_persica"))

gen_dat_brown_top <- gen_dat %>% select(Rename,brown_col_num,brown_light_R,brown_light_G,brown_light_B,brown_med_R,brown_med_G,brown_med_B,brown_dark_R,brown_dark_G,brown_dark_B,brown_excl_R,brown_excl_G,brown_excl_B) %>% filter(Rename %in% mytr_brown_top$tip.label)

gen_dat_brown_top_justpriR <- gen_dat_brown_top %>% select(Rename,brown_med_R)
gen_dat_brown_top_justpriR <- setNames(gen_dat_brown_top_justpriR$brown_med_R,gen_dat_brown_top_justpriR$Rename)

gen_dat_brown_top_justpriG <- gen_dat_brown_top %>% select(Rename,brown_med_G)
gen_dat_brown_top_justpriG <- setNames(gen_dat_brown_top_justpriG$brown_med_G,gen_dat_brown_top_justpriG$Rename)

gen_dat_brown_top_justpriB <- gen_dat_brown_top %>% select(Rename,brown_med_B)
gen_dat_brown_top_justpriB <- setNames(gen_dat_brown_top_justpriB$brown_med_B,gen_dat_brown_top_justpriB$Rename)

fitR<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_brown_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark brown
mytr_brown_top <- keep.tip(mytr_brown_short, c("Panthera_leo_leo","Panthera_leo_persica"))

gen_dat_brown_top <- gen_dat %>% select(Rename,brown_col_num,brown_light_R,brown_light_G,brown_light_B,brown_med_R,brown_med_G,brown_med_B,brown_dark_R,brown_dark_G,brown_dark_B,brown_excl_R,brown_excl_G,brown_excl_B) %>% filter(Rename %in% mytr_brown_top$tip.label)

gen_dat_brown_top_justpriR <- gen_dat_brown_top %>% select(Rename,brown_dark_R)
gen_dat_brown_top_justpriR <- setNames(gen_dat_brown_top_justpriR$brown_dark_R,gen_dat_brown_top_justpriR$Rename)

gen_dat_brown_top_justpriG <- gen_dat_brown_top %>% select(Rename,brown_dark_G)
gen_dat_brown_top_justpriG <- setNames(gen_dat_brown_top_justpriG$brown_dark_G,gen_dat_brown_top_justpriG$Rename)

gen_dat_brown_top_justpriB <- gen_dat_brown_top %>% select(Rename,brown_dark_B)
gen_dat_brown_top_justpriB <- setNames(gen_dat_brown_top_justpriB$brown_dark_B,gen_dat_brown_top_justpriB$Rename)

fitR<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_brown_top,gen_dat_brown_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_brown_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye (doesn't work because only two)
mytr_brown_top <- keep.tip(mytr_brown_short, c("Panthera_leo_leo","Panthera_leo_persica")) 
gen_dat_brown_top_just_pri <- gen_dat %>% select(Rename,brown_pri) %>% filter(Rename %in% mytr_brown_top$tip.label)
gen_dat_brown_top_just_sec<- gen_dat %>% select(Rename,brown_sec) %>% filter(Rename %in% mytr_brown_top$tip.label)
brown_pri <- rayDISC(mytr_brown_top,gen_dat_brown_top_just_pri,model="ER",node.states="marginal")
brown_sec <- rayDISC(mytr_brown_top,gen_dat_brown_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_brown_top,brown_pri$states,piecolors=c("black","white","grey"))
plotRECON(mytr_brown_top,brown_sec$states,piecolors=c("black","white","grey"))
temp1 <- data.frame(brown_pri$states)
temp1 <-temp1 %>% mutate(brown_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(brown_sec$states)
temp2 <-temp2 %>% mutate(brown_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_brown_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```
# reconstruction for top of the tree gray 
```{r}
# light gray
mytr_gray_top <- drop.tip(mytr_gray_short, c("Panthera_leo_persica","Catopuma_temminckii","Leopardus_pardalis_pardalis","Leopardus_colocola_pajeros","Leopardus_geoffroyi","Prionailurus_bengalensis_bengalensis"), trim.internal = TRUE)
gen_dat <- read.csv("general_data_reordered.csv")
gen_dat_gray_top <- gen_dat %>% select(Rename,gray_col_num,gray_light_R,gray_light_G,gray_light_B,gray_med_R,gray_med_G,gray_med_B,gray_dark_R,gray_dark_G,gray_dark_B,gray_excl_R,gray_excl_G,gray_excl_B) %>% filter(Rename %in% mytr_gray_top$tip.label)
gen_dat_gray_top_justpriR <- gen_dat_gray_top %>% select(Rename,gray_light_R)
gen_dat_gray_top_justpriR <- setNames(gen_dat_gray_top_justpriR$gray_light_R,gen_dat_gray_top_justpriR$Rename)

gen_dat_gray_top_justpriG <- gen_dat_gray_top %>% select(Rename,gray_light_G)
gen_dat_gray_top_justpriG <- setNames(gen_dat_gray_top_justpriG$gray_light_G,gen_dat_gray_top_justpriG$Rename)

gen_dat_gray_top_justpriB <- gen_dat_gray_top %>% select(Rename,gray_light_B)
gen_dat_gray_top_justpriB <- setNames(gen_dat_gray_top_justpriB$gray_light_B,gen_dat_gray_top_justpriB$Rename)

fitR<-fastAnc(mytr_gray_top,gen_dat_gray_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_gray_top,gen_dat_gray_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_gray_top,gen_dat_gray_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_gray_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_gray_top_just_col_num <- gen_dat_gray_top %>% select(Rename,gray_col_num)
col_num <- rayDISC(mytr_gray_top,gen_dat_gray_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_gray_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_gray_top$node.label,temp, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium gray
mytr_gray_top <- drop.tip(mytr_gray_short, c("Panthera_leo_persica","Catopuma_temminckii","Leopardus_pardalis_pardalis","Leopardus_colocola_pajeros","Leopardus_geoffroyi","Prionailurus_bengalensis_bengalensis"), trim.internal = TRUE)

gen_dat_gray_top <- gen_dat %>% select(Rename,gray_col_num,gray_light_R,gray_light_G,gray_light_B,gray_med_R,gray_med_G,gray_med_B,gray_dark_R,gray_dark_G,gray_dark_B,gray_excl_R,gray_excl_G,gray_excl_B) %>% filter(Rename %in% mytr_gray_top$tip.label)

gen_dat_gray_top_justpriR <- gen_dat_gray_top %>% select(Rename,gray_med_R)
gen_dat_gray_top_justpriR <- setNames(gen_dat_gray_top_justpriR$gray_med_R,gen_dat_gray_top_justpriR$Rename)

gen_dat_gray_top_justpriG <- gen_dat_gray_top %>% select(Rename,gray_med_G)
gen_dat_gray_top_justpriG <- setNames(gen_dat_gray_top_justpriG$gray_med_G,gen_dat_gray_top_justpriG$Rename)

gen_dat_gray_top_justpriB <- gen_dat_gray_top %>% select(Rename,gray_med_B)
gen_dat_gray_top_justpriB <- setNames(gen_dat_gray_top_justpriB$gray_med_B,gen_dat_gray_top_justpriB$Rename)

fitR<-fastAnc(mytr_gray_top,gen_dat_gray_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_gray_top,gen_dat_gray_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_gray_top,gen_dat_gray_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_gray_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark gray
mytr_gray_top <- drop.tip(mytr_gray_short, c("Panthera_leo_persica","Catopuma_temminckii","Leopardus_pardalis_pardalis","Leopardus_colocola_pajeros","Leopardus_geoffroyi","Prionailurus_bengalensis_bengalensis"), trim.internal = TRUE)

gen_dat_gray_top <- gen_dat %>% select(Rename,gray_col_num,gray_light_R,gray_light_G,gray_light_B,gray_med_R,gray_med_G,gray_med_B,gray_dark_R,gray_dark_G,gray_dark_B,gray_excl_R,gray_excl_G,gray_excl_B) %>% filter(Rename %in% mytr_gray_top$tip.label)

gen_dat_gray_top_justpriR <- gen_dat_gray_top %>% select(Rename,gray_dark_R)
gen_dat_gray_top_justpriR <- setNames(gen_dat_gray_top_justpriR$gray_dark_R,gen_dat_gray_top_justpriR$Rename)

gen_dat_gray_top_justpriG <- gen_dat_gray_top %>% select(Rename,gray_dark_G)
gen_dat_gray_top_justpriG <- setNames(gen_dat_gray_top_justpriG$gray_dark_G,gen_dat_gray_top_justpriG$Rename)

gen_dat_gray_top_justpriB <- gen_dat_gray_top %>% select(Rename,gray_dark_B)
gen_dat_gray_top_justpriB <- setNames(gen_dat_gray_top_justpriB$gray_dark_B,gen_dat_gray_top_justpriB$Rename)

fitR<-fastAnc(mytr_gray_top,gen_dat_gray_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_gray_top,gen_dat_gray_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_gray_top,gen_dat_gray_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_gray_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_gray_top <- drop.tip(mytr_gray_short, c("Panthera_leo_persica","Catopuma_temminckii","Leopardus_pardalis_pardalis","Leopardus_colocola_pajeros","Leopardus_geoffroyi","Prionailurus_bengalensis_bengalensis","Caracal_caracal"), trim.internal = TRUE) # also drop the animals with 4 eye colors
gen_dat_gray_top_just_pri <- gen_dat %>% select(Rename,gray_pri) %>% filter(Rename %in% mytr_gray_top$tip.label)
gen_dat_gray_top_just_sec<- gen_dat %>% select(Rename,gray_sec) %>% filter(Rename %in% mytr_gray_top$tip.label)
gray_pri <- rayDISC(mytr_gray_top,gen_dat_gray_top_just_pri,model="ER",node.states="marginal")
gray_sec <- rayDISC(mytr_gray_top,gen_dat_gray_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_gray_top,gray_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_gray_top,gray_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(gray_pri$states)
temp1 <-temp1 %>% mutate(gray_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(gray_sec$states)
temp2 <-temp2 %>% mutate(gray_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_gray_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```

# reconstruction for panthera yelbei 
```{r}
# light yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Panthera_tigris_tigris_jacksoni","Panthera_tigris_tigris_amoyensis","Panthera_tigris_sondaica","Panthera_tigris_tigris_altaica","Panthera_tigris_tigris_tigris","Panthera_tigris_tigris_corbetti","Panthera_onca","Panthera_leo_leo","Panthera_leo_persica","Panthera_leo_melanochaita"))
gen_dat <- read.csv("general_data_reordered.csv")
gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_light_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_light_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_light_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_yelbei_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_yelbei_top_just_col_num <- gen_dat_yelbei_top %>% select(Rename,yelbei_col_num)
col_num <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,temp, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Panthera_tigris_tigris_jacksoni","Panthera_tigris_tigris_amoyensis","Panthera_tigris_sondaica","Panthera_tigris_tigris_altaica","Panthera_tigris_tigris_tigris","Panthera_tigris_tigris_corbetti","Panthera_onca","Panthera_leo_leo","Panthera_leo_persica","Panthera_leo_melanochaita"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_med_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_med_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_med_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Panthera_tigris_tigris_jacksoni","Panthera_tigris_tigris_amoyensis","Panthera_tigris_sondaica","Panthera_tigris_tigris_altaica","Panthera_tigris_tigris_tigris","Panthera_tigris_tigris_corbetti","Panthera_onca","Panthera_leo_leo","Panthera_leo_persica","Panthera_leo_melanochaita"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_dark_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_dark_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_dark_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Panthera_tigris_tigris_jacksoni","Panthera_tigris_tigris_amoyensis","Panthera_tigris_sondaica","Panthera_tigris_tigris_altaica","Panthera_tigris_tigris_tigris","Panthera_tigris_tigris_corbetti","Panthera_onca","Panthera_leo_leo","Panthera_leo_persica","Panthera_leo_melanochaita")) 
gen_dat_yelbei_top_just_pri <- gen_dat %>% select(Rename,yelbei_pri) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_just_sec<- gen_dat %>% select(Rename,yelbei_sec) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
yelbei_pri <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_pri,model="ER",node.states="marginal")
yelbei_sec <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,yelbei_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_yelbei_top,yelbei_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(yelbei_pri$states)
temp1 <-temp1 %>% mutate(yelbei_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(yelbei_sec$states)
temp2 <-temp2 %>% mutate(yelbei_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```

# reconstruction for Lynx yelbei 
```{r}
# light yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Lynx_canadensis","Lynx_lynx","Lynx_pardinus"))
gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_light_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_light_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_light_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_yelbei_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_yelbei_top_just_col_num <- gen_dat_yelbei_top %>% select(Rename,yelbei_col_num)
col_num <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Lynx_canadensis","Lynx_lynx","Lynx_pardinus"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_med_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_med_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_med_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Lynx_canadensis","Lynx_lynx","Lynx_pardinus"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_dark_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_dark_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_dark_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Lynx_canadensis","Lynx_lynx","Lynx_pardinus"))

gen_dat_yelbei_top_just_pri <- gen_dat %>% select(Rename,yelbei_pri) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_just_sec<- gen_dat %>% select(Rename,yelbei_sec) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
yelbei_pri <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_pri,model="ER",node.states="marginal")
yelbei_sec <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,yelbei_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_yelbei_top,yelbei_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(yelbei_pri$states)
temp1 <-temp1 %>% mutate(yelbei_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(yelbei_sec$states)
temp2 <-temp2 %>% mutate(yelbei_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```
# reconstruction for Acinonyx/Puma yelbei 
```{r}
# light yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Acinonyx_jubatus","Puma_concolor"))
gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_light_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_light_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_light_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_yelbei_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_yelbei_top_just_col_num <- gen_dat_yelbei_top %>% select(Rename,yelbei_col_num)
col_num <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Acinonyx_jubatus","Puma_concolor"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_med_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_med_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_med_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Acinonyx_jubatus","Puma_concolor"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_dark_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_dark_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_dark_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Acinonyx_jubatus","Puma_concolor"))

gen_dat_yelbei_top_just_pri <- gen_dat %>% select(Rename,yelbei_pri) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_just_sec<- gen_dat %>% select(Rename,yelbei_sec) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
yelbei_pri <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_pri,model="ER",node.states="marginal")
yelbei_sec <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,yelbei_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_yelbei_top,yelbei_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(yelbei_pri$states)
temp1 <-temp1 %>% mutate(yelbei_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(yelbei_sec$states)
temp2 <-temp2 %>% mutate(yelbei_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```

# reconstruction for Prionailurus yelbei 
```{r}
# light yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Prionailurus_bengalensis_iriomotensis","Prionailurus_bengalensis_bengalensis"))
gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_light_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_light_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_light_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_yelbei_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_yelbei_top_just_col_num <- gen_dat_yelbei_top %>% select(Rename,yelbei_col_num)
col_num <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Prionailurus_bengalensis_iriomotensis","Prionailurus_bengalensis_bengalensis"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_med_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_med_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_med_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Prionailurus_bengalensis_iriomotensis","Prionailurus_bengalensis_bengalensis"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_dark_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_dark_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_dark_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Prionailurus_bengalensis_iriomotensis","Prionailurus_bengalensis_bengalensis"))

gen_dat_yelbei_top_just_pri <- gen_dat %>% select(Rename,yelbei_pri) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_just_sec<- gen_dat %>% select(Rename,yelbei_sec) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
yelbei_pri <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_pri,model="ER",node.states="marginal")
yelbei_sec <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,yelbei_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_yelbei_top,yelbei_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(yelbei_pri$states)
temp1 <-temp1 %>% mutate(yelbei_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(yelbei_sec$states)
temp2 <-temp2 %>% mutate(yelbei_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```

# reconstruction for Prionailurus/Otocolobus yelbei 
```{r}
# light yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Otocolobus_manul","Prionailurus_rubiginosus"))
gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_light_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_light_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_light_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_yelbei_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_yelbei_top_just_col_num <- gen_dat_yelbei_top %>% select(Rename,yelbei_col_num)
col_num <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Otocolobus_manul","Prionailurus_rubiginosus"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_med_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_med_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_med_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Otocolobus_manul","Prionailurus_rubiginosus"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_dark_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_dark_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_dark_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Otocolobus_manul","Prionailurus_rubiginosus"))

gen_dat_yelbei_top_just_pri <- gen_dat %>% select(Rename,yelbei_pri) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_just_sec<- gen_dat %>% select(Rename,yelbei_sec) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
yelbei_pri <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_pri,model="ER",node.states="marginal")
yelbei_sec <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,yelbei_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_yelbei_top,yelbei_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(yelbei_pri$states)
temp1 <-temp1 %>% mutate(yelbei_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(yelbei_sec$states)
temp2 <-temp2 %>% mutate(yelbei_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```

# reconstruction for Felis yelbei 
```{r}
# light yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Felis_lybica_lybica","Felis_lybica_cafra"))
gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_light_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_light_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_light_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_light_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_yelbei_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_yelbei_top_just_col_num <- gen_dat_yelbei_top %>% select(Rename,yelbei_col_num)
col_num <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Felis_lybica_lybica","Felis_lybica_cafra"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_med_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_med_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_med_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_med_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark yelbei
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Felis_lybica_lybica","Felis_lybica_cafra"))

gen_dat_yelbei_top <- gen_dat %>% select(Rename,yelbei_col_num,yelbei_light_R,yelbei_light_G,yelbei_light_B,yelbei_med_R,yelbei_med_G,yelbei_med_B,yelbei_dark_R,yelbei_dark_G,yelbei_dark_B) %>% filter(Rename %in% mytr_yelbei_top$tip.label)

gen_dat_yelbei_top_justpriR <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_R)
gen_dat_yelbei_top_justpriR <- setNames(gen_dat_yelbei_top_justpriR$yelbei_dark_R,gen_dat_yelbei_top_justpriR$Rename)

gen_dat_yelbei_top_justpriG <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_G)
gen_dat_yelbei_top_justpriG <- setNames(gen_dat_yelbei_top_justpriG$yelbei_dark_G,gen_dat_yelbei_top_justpriG$Rename)

gen_dat_yelbei_top_justpriB <- gen_dat_yelbei_top %>% select(Rename,yelbei_dark_B)
gen_dat_yelbei_top_justpriB <- setNames(gen_dat_yelbei_top_justpriB$yelbei_dark_B,gen_dat_yelbei_top_justpriB$Rename)

fitR<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_yelbei_top,gen_dat_yelbei_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_yelbei_top <- keep.tip(mytr_yelbei_short, c("Felis_lybica_lybica","Felis_lybica_cafra"))

gen_dat_yelbei_top_just_pri <- gen_dat %>% select(Rename,yelbei_pri) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
gen_dat_yelbei_top_just_sec<- gen_dat %>% select(Rename,yelbei_sec) %>% filter(Rename %in% mytr_yelbei_top$tip.label)
yelbei_pri <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_pri,model="ER",node.states="marginal")
yelbei_sec <- rayDISC(mytr_yelbei_top,gen_dat_yelbei_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_yelbei_top,yelbei_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_yelbei_top,yelbei_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(yelbei_pri$states)
temp1 <-temp1 %>% mutate(yelbei_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(yelbei_sec$states)
temp2 <-temp2 %>% mutate(yelbei_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_yelbei_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```

# reconstruction for lynx hazgre 
```{r}
# light hazgre
mytr_hazgre_top <- keep.tip(mytr_hazgre_short, c("Lynx_lynx","Lynx_pardinus"))
gen_dat_hazgre_top <- gen_dat %>% select(Rename,hazgre_col_num,hazgre_light_R,hazgre_light_G,hazgre_light_B,hazgre_med_R,hazgre_med_G,hazgre_med_B,hazgre_dark_R,hazgre_dark_G,hazgre_dark_B) %>% filter(Rename %in% mytr_hazgre_top$tip.label)
gen_dat_hazgre_top_justpriR <- gen_dat_hazgre_top %>% select(Rename,hazgre_light_R)
gen_dat_hazgre_top_justpriR <- setNames(gen_dat_hazgre_top_justpriR$hazgre_light_R,gen_dat_hazgre_top_justpriR$Rename)

gen_dat_hazgre_top_justpriG <- gen_dat_hazgre_top %>% select(Rename,hazgre_light_G)
gen_dat_hazgre_top_justpriG <- setNames(gen_dat_hazgre_top_justpriG$hazgre_light_G,gen_dat_hazgre_top_justpriG$Rename)

gen_dat_hazgre_top_justpriB <- gen_dat_hazgre_top %>% select(Rename,hazgre_light_B)
gen_dat_hazgre_top_justpriB <- setNames(gen_dat_hazgre_top_justpriB$hazgre_light_B,gen_dat_hazgre_top_justpriB$Rename)

fitR<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_hazgre_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_hazgre_top_just_col_num <- gen_dat_hazgre_top %>% select(Rename,hazgre_col_num)
col_num <- rayDISC(mytr_hazgre_top,gen_dat_hazgre_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_hazgre_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_hazgre_top$node.label,fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium hazgre
mytr_hazgre_top <- keep.tip(mytr_hazgre_short, c("Lynx_lynx","Lynx_pardinus"))

gen_dat_hazgre_top <- gen_dat %>% select(Rename,hazgre_col_num,hazgre_light_R,hazgre_light_G,hazgre_light_B,hazgre_med_R,hazgre_med_G,hazgre_med_B,hazgre_dark_R,hazgre_dark_G,hazgre_dark_B) %>% filter(Rename %in% mytr_hazgre_top$tip.label)

gen_dat_hazgre_top_justpriR <- gen_dat_hazgre_top %>% select(Rename,hazgre_med_R)
gen_dat_hazgre_top_justpriR <- setNames(gen_dat_hazgre_top_justpriR$hazgre_med_R,gen_dat_hazgre_top_justpriR$Rename)

gen_dat_hazgre_top_justpriG <- gen_dat_hazgre_top %>% select(Rename,hazgre_med_G)
gen_dat_hazgre_top_justpriG <- setNames(gen_dat_hazgre_top_justpriG$hazgre_med_G,gen_dat_hazgre_top_justpriG$Rename)

gen_dat_hazgre_top_justpriB <- gen_dat_hazgre_top %>% select(Rename,hazgre_med_B)
gen_dat_hazgre_top_justpriB <- setNames(gen_dat_hazgre_top_justpriB$hazgre_med_B,gen_dat_hazgre_top_justpriB$Rename)

fitR<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_hazgre_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark hazgre
mytr_hazgre_top <- keep.tip(mytr_hazgre_short, c("Lynx_lynx","Lynx_pardinus"))

gen_dat_hazgre_top <- gen_dat %>% select(Rename,hazgre_col_num,hazgre_light_R,hazgre_light_G,hazgre_light_B,hazgre_med_R,hazgre_med_G,hazgre_med_B,hazgre_dark_R,hazgre_dark_G,hazgre_dark_B) %>% filter(Rename %in% mytr_hazgre_top$tip.label)

gen_dat_hazgre_top_justpriR <- gen_dat_hazgre_top %>% select(Rename,hazgre_dark_R)
gen_dat_hazgre_top_justpriR <- setNames(gen_dat_hazgre_top_justpriR$hazgre_dark_R,gen_dat_hazgre_top_justpriR$Rename)

gen_dat_hazgre_top_justpriG <- gen_dat_hazgre_top %>% select(Rename,hazgre_dark_G)
gen_dat_hazgre_top_justpriG <- setNames(gen_dat_hazgre_top_justpriG$hazgre_dark_G,gen_dat_hazgre_top_justpriG$Rename)

gen_dat_hazgre_top_justpriB <- gen_dat_hazgre_top %>% select(Rename,hazgre_dark_B)
gen_dat_hazgre_top_justpriB <- setNames(gen_dat_hazgre_top_justpriB$hazgre_dark_B,gen_dat_hazgre_top_justpriB$Rename)

fitR<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_hazgre_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_hazgre_top <- keep.tip(mytr_hazgre_short, c("Lynx_lynx","Lynx_pardinus"))

gen_dat_hazgre_top_just_pri <- gen_dat %>% select(Rename,hazgre_pri) %>% filter(Rename %in% mytr_hazgre_top$tip.label)
gen_dat_hazgre_top_just_sec<- gen_dat %>% select(Rename,hazgre_sec) %>% filter(Rename %in% mytr_hazgre_top$tip.label)
hazgre_pri <- rayDISC(mytr_hazgre_top,gen_dat_hazgre_top_just_pri,model="ER",node.states="marginal")
hazgre_sec <- rayDISC(mytr_hazgre_top,gen_dat_hazgre_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_hazgre_top,hazgre_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_hazgre_top,hazgre_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(hazgre_pri$states)
temp1 <-temp1 %>% mutate(hazgre_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(hazgre_sec$states)
temp2 <-temp2 %>% mutate(hazgre_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_hazgre_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```

# reconstruction for felis hazgre 
```{r}
# light hazgre
mytr_hazgre_top <- keep.tip(mytr_hazgre_short, c("Felis_chaus_affinis","Felis_chaus_chaus","Felis_nigripes","Felis_margarita","Felis_lybica_lybica","Felis_lybica_ornata","Felis_lybica_cafra","Felis_silvestris"))
gen_dat_hazgre_top <- gen_dat %>% select(Rename,hazgre_col_num,hazgre_light_R,hazgre_light_G,hazgre_light_B,hazgre_med_R,hazgre_med_G,hazgre_med_B,hazgre_dark_R,hazgre_dark_G,hazgre_dark_B) %>% filter(Rename %in% mytr_hazgre_top$tip.label)
gen_dat_hazgre_top_justpriR <- gen_dat_hazgre_top %>% select(Rename,hazgre_light_R)
gen_dat_hazgre_top_justpriR <- setNames(gen_dat_hazgre_top_justpriR$hazgre_light_R,gen_dat_hazgre_top_justpriR$Rename)

gen_dat_hazgre_top_justpriG <- gen_dat_hazgre_top %>% select(Rename,hazgre_light_G)
gen_dat_hazgre_top_justpriG <- setNames(gen_dat_hazgre_top_justpriG$hazgre_light_G,gen_dat_hazgre_top_justpriG$Rename)

gen_dat_hazgre_top_justpriB <- gen_dat_hazgre_top %>% select(Rename,hazgre_light_B)
gen_dat_hazgre_top_justpriB <- setNames(gen_dat_hazgre_top_justpriB$hazgre_light_B,gen_dat_hazgre_top_justpriB$Rename)

fitR<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_hazgre_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_hazgre_top_just_col_num <- gen_dat_hazgre_top %>% select(Rename,hazgre_col_num)
col_num <- rayDISC(mytr_hazgre_top,gen_dat_hazgre_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_hazgre_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_hazgre_top$node.label,temp,fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium hazgre
mytr_hazgre_top <- keep.tip(mytr_hazgre_short, c("Felis_chaus_affinis","Felis_chaus_chaus","Felis_nigripes","Felis_margarita","Felis_lybica_lybica","Felis_lybica_ornata","Felis_lybica_cafra","Felis_silvestris"))

gen_dat_hazgre_top <- gen_dat %>% select(Rename,hazgre_col_num,hazgre_light_R,hazgre_light_G,hazgre_light_B,hazgre_med_R,hazgre_med_G,hazgre_med_B,hazgre_dark_R,hazgre_dark_G,hazgre_dark_B) %>% filter(Rename %in% mytr_hazgre_top$tip.label)

gen_dat_hazgre_top_justpriR <- gen_dat_hazgre_top %>% select(Rename,hazgre_med_R)
gen_dat_hazgre_top_justpriR <- setNames(gen_dat_hazgre_top_justpriR$hazgre_med_R,gen_dat_hazgre_top_justpriR$Rename)

gen_dat_hazgre_top_justpriG <- gen_dat_hazgre_top %>% select(Rename,hazgre_med_G)
gen_dat_hazgre_top_justpriG <- setNames(gen_dat_hazgre_top_justpriG$hazgre_med_G,gen_dat_hazgre_top_justpriG$Rename)

gen_dat_hazgre_top_justpriB <- gen_dat_hazgre_top %>% select(Rename,hazgre_med_B)
gen_dat_hazgre_top_justpriB <- setNames(gen_dat_hazgre_top_justpriB$hazgre_med_B,gen_dat_hazgre_top_justpriB$Rename)

fitR<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_hazgre_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark hazgre
mytr_hazgre_top <- keep.tip(mytr_hazgre_short, c("Felis_chaus_affinis","Felis_chaus_chaus","Felis_nigripes","Felis_margarita","Felis_lybica_lybica","Felis_lybica_ornata","Felis_lybica_cafra","Felis_silvestris"))

gen_dat_hazgre_top <- gen_dat %>% select(Rename,hazgre_col_num,hazgre_light_R,hazgre_light_G,hazgre_light_B,hazgre_med_R,hazgre_med_G,hazgre_med_B,hazgre_dark_R,hazgre_dark_G,hazgre_dark_B) %>% filter(Rename %in% mytr_hazgre_top$tip.label)

gen_dat_hazgre_top_justpriR <- gen_dat_hazgre_top %>% select(Rename,hazgre_dark_R)
gen_dat_hazgre_top_justpriR <- setNames(gen_dat_hazgre_top_justpriR$hazgre_dark_R,gen_dat_hazgre_top_justpriR$Rename)

gen_dat_hazgre_top_justpriG <- gen_dat_hazgre_top %>% select(Rename,hazgre_dark_G)
gen_dat_hazgre_top_justpriG <- setNames(gen_dat_hazgre_top_justpriG$hazgre_dark_G,gen_dat_hazgre_top_justpriG$Rename)

gen_dat_hazgre_top_justpriB <- gen_dat_hazgre_top %>% select(Rename,hazgre_dark_B)
gen_dat_hazgre_top_justpriB <- setNames(gen_dat_hazgre_top_justpriB$hazgre_dark_B,gen_dat_hazgre_top_justpriB$Rename)

fitR<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_hazgre_top,gen_dat_hazgre_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_hazgre_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_hazgre_top <- keep.tip(mytr_hazgre_short, c("Felis_chaus_affinis","Felis_chaus_chaus","Felis_nigripes","Felis_margarita","Felis_lybica_lybica","Felis_lybica_ornata","Felis_lybica_cafra","Felis_silvestris"))

gen_dat_hazgre_top_just_pri <- gen_dat %>% select(Rename,hazgre_pri) %>% filter(Rename %in% mytr_hazgre_top$tip.label)
gen_dat_hazgre_top_just_sec<- gen_dat %>% select(Rename,hazgre_sec) %>% filter(Rename %in% mytr_hazgre_top$tip.label)
hazgre_pri <- rayDISC(mytr_hazgre_top,gen_dat_hazgre_top_just_pri,model="ER",node.states="marginal")
hazgre_sec <- rayDISC(mytr_hazgre_top,gen_dat_hazgre_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_hazgre_top,hazgre_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_hazgre_top,hazgre_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(hazgre_pri$states)
temp1 <-temp1 %>% mutate(hazgre_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(hazgre_sec$states)
temp2 <-temp2 %>% mutate(hazgre_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_hazgre_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```

# reconstruction for panthera blue 
```{r}
# light blue
mytr_blue_top <- keep.tip(mytr_blue_short, c("Panthera_pardus_fusca","Panthera_pardus_orientalis"))
gen_dat_blue_top <- gen_dat %>% select(Rename,blue_col_num,blue_light_R,blue_light_G,blue_light_B,blue_med_R,blue_med_G,blue_med_B,blue_dark_R,blue_dark_G,blue_dark_B) %>% filter(Rename %in% mytr_blue_top$tip.label)
gen_dat_blue_top_justpriR <- gen_dat_blue_top %>% select(Rename,blue_light_R)
gen_dat_blue_top_justpriR <- setNames(gen_dat_blue_top_justpriR$blue_light_R,gen_dat_blue_top_justpriR$Rename)

gen_dat_blue_top_justpriG <- gen_dat_blue_top %>% select(Rename,blue_light_G)
gen_dat_blue_top_justpriG <- setNames(gen_dat_blue_top_justpriG$blue_light_G,gen_dat_blue_top_justpriG$Rename)

gen_dat_blue_top_justpriB <- gen_dat_blue_top %>% select(Rename,blue_light_B)
gen_dat_blue_top_justpriB <- setNames(gen_dat_blue_top_justpriB$blue_light_B,gen_dat_blue_top_justpriB$Rename)

fitR<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_blue_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_blue_top_just_col_num <- gen_dat_blue_top %>% select(Rename,blue_col_num)
col_num <- rayDISC(mytr_blue_top,gen_dat_blue_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_blue_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_blue_top$node.label,fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium blue
mytr_blue_top <- keep.tip(mytr_blue_short, c("Panthera_pardus_fusca","Panthera_pardus_orientalis"))

gen_dat_blue_top <- gen_dat %>% select(Rename,blue_col_num,blue_light_R,blue_light_G,blue_light_B,blue_med_R,blue_med_G,blue_med_B,blue_dark_R,blue_dark_G,blue_dark_B) %>% filter(Rename %in% mytr_blue_top$tip.label)

gen_dat_blue_top_justpriR <- gen_dat_blue_top %>% select(Rename,blue_med_R)
gen_dat_blue_top_justpriR <- setNames(gen_dat_blue_top_justpriR$blue_med_R,gen_dat_blue_top_justpriR$Rename)

gen_dat_blue_top_justpriG <- gen_dat_blue_top %>% select(Rename,blue_med_G)
gen_dat_blue_top_justpriG <- setNames(gen_dat_blue_top_justpriG$blue_med_G,gen_dat_blue_top_justpriG$Rename)

gen_dat_blue_top_justpriB <- gen_dat_blue_top %>% select(Rename,blue_med_B)
gen_dat_blue_top_justpriB <- setNames(gen_dat_blue_top_justpriB$blue_med_B,gen_dat_blue_top_justpriB$Rename)

fitR<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_blue_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark blue
mytr_blue_top <- keep.tip(mytr_blue_short, c("Panthera_pardus_fusca","Panthera_pardus_orientalis"))

gen_dat_blue_top <- gen_dat %>% select(Rename,blue_col_num,blue_light_R,blue_light_G,blue_light_B,blue_med_R,blue_med_G,blue_med_B,blue_dark_R,blue_dark_G,blue_dark_B) %>% filter(Rename %in% mytr_blue_top$tip.label)

gen_dat_blue_top_justpriR <- gen_dat_blue_top %>% select(Rename,blue_dark_R)
gen_dat_blue_top_justpriR <- setNames(gen_dat_blue_top_justpriR$blue_dark_R,gen_dat_blue_top_justpriR$Rename)

gen_dat_blue_top_justpriG <- gen_dat_blue_top %>% select(Rename,blue_dark_G)
gen_dat_blue_top_justpriG <- setNames(gen_dat_blue_top_justpriG$blue_dark_G,gen_dat_blue_top_justpriG$Rename)

gen_dat_blue_top_justpriB <- gen_dat_blue_top %>% select(Rename,blue_dark_B)
gen_dat_blue_top_justpriB <- setNames(gen_dat_blue_top_justpriB$blue_dark_B,gen_dat_blue_top_justpriB$Rename)

fitR<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_blue_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_blue_top <- keep.tip(mytr_blue_short, c("Panthera_pardus_fusca","Panthera_pardus_orientalis"))

gen_dat_blue_top_just_pri <- gen_dat %>% select(Rename,blue_pri) %>% filter(Rename %in% mytr_blue_top$tip.label)
gen_dat_blue_top_just_sec<- gen_dat %>% select(Rename,blue_sec) %>% filter(Rename %in% mytr_blue_top$tip.label)
blue_pri <- rayDISC(mytr_blue_top,gen_dat_blue_top_just_pri,model="ER",node.states="marginal")
blue_sec <- rayDISC(mytr_blue_top,gen_dat_blue_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_blue_top,blue_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_blue_top,blue_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(blue_pri$states)
temp1 <-temp1 %>% mutate(blue_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(blue_sec$states)
temp2 <-temp2 %>% mutate(blue_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_blue_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```

# reconstruction for felis blue 
```{r}
# light blue
mytr_blue_top <- keep.tip(mytr_blue_short, c("Felis_bieti","Felis_silvestris"))
gen_dat_blue_top <- gen_dat %>% select(Rename,blue_col_num,blue_light_R,blue_light_G,blue_light_B,blue_med_R,blue_med_G,blue_med_B,blue_dark_R,blue_dark_G,blue_dark_B) %>% filter(Rename %in% mytr_blue_top$tip.label)
gen_dat_blue_top_justpriR <- gen_dat_blue_top %>% select(Rename,blue_light_R)
gen_dat_blue_top_justpriR <- setNames(gen_dat_blue_top_justpriR$blue_light_R,gen_dat_blue_top_justpriR$Rename)

gen_dat_blue_top_justpriG <- gen_dat_blue_top %>% select(Rename,blue_light_G)
gen_dat_blue_top_justpriG <- setNames(gen_dat_blue_top_justpriG$blue_light_G,gen_dat_blue_top_justpriG$Rename)

gen_dat_blue_top_justpriB <- gen_dat_blue_top %>% select(Rename,blue_light_B)
gen_dat_blue_top_justpriB <- setNames(gen_dat_blue_top_justpriB$blue_light_B,gen_dat_blue_top_justpriB$Rename)

fitR<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

plot(mytr_blue_top, show.node.label = TRUE)
```

```{r}
# reconstruct the number of colors in each eye
gen_dat_blue_top_just_col_num <- gen_dat_blue_top %>% select(Rename,blue_col_num)
col_num <- rayDISC(mytr_blue_top,gen_dat_blue_top_just_col_num,model="ER",node.states="marginal")
plotRECON(mytr_blue_top,col_num$states,piecolors=c("white","gray","black"))
temp <- data.frame(col_num$states)
temp <-temp %>% mutate(col_num=names(.)[max.col(.)])
temp <- temp[,ncol(temp)]

# put data in an exportable format
frame <- data.frame(mytr_blue_top$node.label,fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# medium blue
mytr_blue_top <- keep.tip(mytr_blue_short, c("Felis_bieti","Felis_silvestris"))

gen_dat_blue_top <- gen_dat %>% select(Rename,blue_col_num,blue_light_R,blue_light_G,blue_light_B,blue_med_R,blue_med_G,blue_med_B,blue_dark_R,blue_dark_G,blue_dark_B) %>% filter(Rename %in% mytr_blue_top$tip.label)

gen_dat_blue_top_justpriR <- gen_dat_blue_top %>% select(Rename,blue_med_R)
gen_dat_blue_top_justpriR <- setNames(gen_dat_blue_top_justpriR$blue_med_R,gen_dat_blue_top_justpriR$Rename)

gen_dat_blue_top_justpriG <- gen_dat_blue_top %>% select(Rename,blue_med_G)
gen_dat_blue_top_justpriG <- setNames(gen_dat_blue_top_justpriG$blue_med_G,gen_dat_blue_top_justpriG$Rename)

gen_dat_blue_top_justpriB <- gen_dat_blue_top %>% select(Rename,blue_med_B)
gen_dat_blue_top_justpriB <- setNames(gen_dat_blue_top_justpriB$blue_med_B,gen_dat_blue_top_justpriB$Rename)

fitR<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_blue_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# dark blue
mytr_blue_top <- keep.tip(mytr_blue_short, c("Felis_bieti","Felis_silvestris"))

gen_dat_blue_top <- gen_dat %>% select(Rename,blue_col_num,blue_light_R,blue_light_G,blue_light_B,blue_med_R,blue_med_G,blue_med_B,blue_dark_R,blue_dark_G,blue_dark_B) %>% filter(Rename %in% mytr_blue_top$tip.label)

gen_dat_blue_top_justpriR <- gen_dat_blue_top %>% select(Rename,blue_dark_R)
gen_dat_blue_top_justpriR <- setNames(gen_dat_blue_top_justpriR$blue_dark_R,gen_dat_blue_top_justpriR$Rename)

gen_dat_blue_top_justpriG <- gen_dat_blue_top %>% select(Rename,blue_dark_G)
gen_dat_blue_top_justpriG <- setNames(gen_dat_blue_top_justpriG$blue_dark_G,gen_dat_blue_top_justpriG$Rename)

gen_dat_blue_top_justpriB <- gen_dat_blue_top %>% select(Rename,blue_dark_B)
gen_dat_blue_top_justpriB <- setNames(gen_dat_blue_top_justpriB$blue_dark_B,gen_dat_blue_top_justpriB$Rename)

fitR<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriR,vars=TRUE,CI=TRUE)
print(fitR,printlen=10)

fitG<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriG,vars=TRUE,CI=TRUE)
print(fitG,printlen=10)

fitB<-fastAnc(mytr_blue_top,gen_dat_blue_top_justpriB,vars=TRUE,CI=TRUE)
print(fitB,printlen=10)

# put data in an exportable format
frame <- data.frame(mytr_blue_top$node.label, fitR$ace,fitG$ace,fitB$ace)
write.csv(frame,"tempdata.csv")
```

```{r}
# reconstruct the primary and secondary colors in each eye
mytr_blue_top <- keep.tip(mytr_blue_short, c("Felis_bieti","Felis_silvestris"))

gen_dat_blue_top_just_pri <- gen_dat %>% select(Rename,blue_pri) %>% filter(Rename %in% mytr_blue_top$tip.label)
gen_dat_blue_top_just_sec<- gen_dat %>% select(Rename,blue_sec) %>% filter(Rename %in% mytr_blue_top$tip.label)
blue_pri <- rayDISC(mytr_blue_top,gen_dat_blue_top_just_pri,model="ER",node.states="marginal")
blue_sec <- rayDISC(mytr_blue_top,gen_dat_blue_top_just_sec,model="ER",node.states="marginal")
plotRECON(mytr_blue_top,blue_pri$states,piecolors=c("black","white","gray"))
plotRECON(mytr_blue_top,blue_sec$states,piecolors=c("black","white","gray"))
temp1 <- data.frame(blue_pri$states)
temp1 <-temp1 %>% mutate(blue_pri=names(.)[max.col(.)])
temp1 <- temp1[,ncol(temp1)]

temp2 <- data.frame(blue_sec$states)
temp2 <-temp2 %>% mutate(blue_sec=names(.)[max.col(.)])
temp2 <- temp2[,ncol(temp2)]


# put data in an exportable format
frame <- data.frame(mytr_blue_top$node.label,temp1,temp2)
write.csv(frame,"tempdata.csv")
```